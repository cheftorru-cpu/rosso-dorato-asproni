<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Rosso Dorato Asproni</title>

<style>
body{font-family:Arial;background:#f4f4f4;padding:10px}
h1{text-align:center}
.box{background:white;padding:10px;margin-bottom:15px;border-radius:10px}
input,select,button{width:100%;padding:8px;margin:5px 0}
button{background:#b00000;color:white;border:none;border-radius:6px}
.month{background:#eee;padding:8px;margin-top:10px;border-radius:6px}
.day{padding:6px;border-bottom:1px solid #ddd}
.small{font-size:12px;color:#555}
</style>
</head>

<body>

<h1>üç∑ Rosso Dorato Asproni</h1>

<div class="box">
<h2>üìÖ Inserisci giornata</h2>
<input type="date" id="data">

<input type="number" id="contanti" placeholder="Contanti">
<input type="number" id="pos" placeholder="POS">
<input type="number" id="satis" placeholder="Satispay">

<input type="number" id="food" placeholder="Spese Food">
<input id="fornFood" placeholder="Fornitore Food">

<input type="number" id="nonfood" placeholder="Spese Non Food">
<input id="fornNon" placeholder="Fornitore Non Food">

<input type="number" id="extra" placeholder="Extra personale">

<button onclick="salva()">üíæ Salva giornata</button>
</div>

<div class="box">
<h2>üìö Storico</h2>
<div id="storico"></div>
</div>

<script>
let dati = JSON.parse(localStorage.getItem("dati")) || [];

function salva(){
 if(!data.value) return alert("Seleziona la data");
 if(dati.find(d=>d.data==data.value)) return alert("Data gi√† inserita");

 dati.push({
  data:data.value,
  cont:+contanti.value||0,
  pos:+pos.value||0,
  sat:+satis.value||0,
  food:+food.value||0,
  ffood:fornFood.value,
  non:+nonfood.value||0,
  fnon:fornNon.value,
  extra:+extra.value||0
 });

 localStorage.setItem("dati",JSON.stringify(dati));
 aggiornaStorico();
}

function aggiornaStorico(){
 let mesi={};

 dati.forEach(g=>{
  let m=g.data.substring(0,7);
  mesi[m]=mesi[m]||[];
  mesi[m].push(g);
 });

 storico.innerHTML="";

 Object.keys(mesi).sort().reverse().forEach(m=>{
  let div=document.createElement("div");
  div.className="month";
  div.innerHTML=`<b>${m}</b>`;

  mesi[m].sort((a,b)=>a.data.localeCompare(b.data)).forEach(g=>{
    let inc=g.cont+g.pos+g.sat;
    let sp=g.food+g.non+g.extra;
    div.innerHTML+=`
    <div class="day">
     ${g.data}<br>
     Incassi ${inc}‚Ç¨ ‚Äì Spese ${sp}‚Ç¨ ‚Äì Utile ${inc-sp}‚Ç¨
     <div class="small">
      Food ${g.food}‚Ç¨ (${g.ffood||"-"})<br>
      Non food ${g.non}‚Ç¨ (${g.fnon||"-"})
     </div>
    </div>`;
  });

 storico.appendChild(div);
 });
}

aggiornaStorico();
</script>

</body>
</html>
