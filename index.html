<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rosso Dorato - Gestione Completa</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', sans-serif; background: linear-gradient(135deg, #ff6b6b, #4ecdc4); min-height: 100vh; padding: 20px; }
        .container { max-width: 900px; margin: 0 auto; background: white; border-radius: 20px; box-shadow: 0 20px 40px rgba(0,0,0,0.1); overflow: hidden; }
        .header { background: #ff6b6b; color: white; padding: 20px; text-align: center; }
        .tabs { display: flex; background: #f8f9fa; flex-wrap: wrap; }
        .tab { flex: 1; min-width: 120px; padding: 15px; text-align: center; cursor: pointer; border-bottom: 3px solid transparent; }
        .tab.active { background: white; border-bottom-color: #ff6b6b; font-weight: bold; }
        .tab-content { display: none; padding: 30px; }
        .tab-content.active { display: block; }
        input, select { width: 100%; padding: 12px; margin: 10px 0; border: 1px solid #ddd; border-radius: 8px; font-size: 16px; }
        button { background: #4ecdc4; color: white; border: none; padding: 12px 24px; border-radius: 8px; cursor: pointer; font-size: 16px; margin: 5px; }
        button:hover { background: #45b7aa; }
        .item { background: #f8f9fa; padding: 15px; margin: 10px 0; border-radius: 8px; display: flex; justify-content: space-between; align-items: center; }
        .item button { background: #ff6b6b; padding: 8px 12px; font-size: 14px; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { padding: 12px; text-align: left; border-bottom: 1px solid #ddd; }
        th { background: #ff6b6b; color: white; }
        .stats { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-top: 20px; }
        .stat { background: #e9ecef; padding: 20px; border-radius: 10px; text-align: center; }
        .payment-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin: 10px 0; }
        .today-highlight { background: #fff3cd !important; border: 2px solid #ffc107; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üçÖ Rosso Dorato Gestione</h1>
            <p>Magazzino ‚Ä¢ Ricette ‚Ä¢ Incassi ‚Ä¢ Ordini</p>
        </div>
        
        <div class="tabs">
            <div class="tab active" onclick="showTab('incassi')">üí∞ Incassi</div>
            <div class="tab" onclick="showTab('magazzino')">üì¶ Magazzino</div>
            <div class="tab" onclick="showTab('ricette')">üë®‚Äçüç≥ Ricette</div>
            <div class="tab" onclick="showTab('ordini')">üìã Ordini</div>
            <div class="tab" onclick="showTab('stats')">üìä Dashboard</div>
        </div>
        
        <div id="incassi" class="tab-content active">
            <h2>üí∞ Incassi Giornalieri</h2>
            <input id="incassoData" type="date" onchange="updateDisplay()">
            <div class="payment-grid">
                <input id="posAmount" type="number" step="0.01" placeholder="POS (‚Ç¨)">
                <input id="cashAmount" type="number" step="0.01" placeholder="Contanti (‚Ç¨)">
                <input id="sardexAmount" type="number" step="0.01" placeholder="Sardex (cr.)">
                <input id="noteAmount" style="grid-column: span 3;" placeholder="Note/Altro">
            </div>
            <button onclick="addIncasso()">‚ûï Registra Incasso</button>
            <div id="incassiList"></div>
        </div>
        
        <div id="magazzino" class="tab-content">
            <h2>üì¶ Magazzino</h2>
            <input id="itemName" placeholder="Farina 00">
            <input id="itemQty" type="number" placeholder="Quantit√† (kg)">
            <input id="itemPrice" type="number" step="0.01" placeholder="Prezzo (‚Ç¨/kg)">
            <button onclick="addItem()">‚ûï Aggiungi</button>
            <div id="inventoryList"></div>
        </div>
        
        <div id="ricette" class="tab-content">
            <h2>üë®‚Äçüç≥ Ricette</h2>
            <input id="recipeName" placeholder="Pizza Margherita">
            <input id="recipeCost" type="number" step="0.01" placeholder="Costo Totale (‚Ç¨)">
            <input id="recipePrice" type="number" step="0.01" placeholder="Prezzo Vendita (‚Ç¨)">
            <button onclick="addRecipe()">‚ûï Salva Ricetta</button>
            <div id="recipesList"></div>
        </div>
        
        <div id="ordini" class="tab-content">
            <h2>üìã Ordini Fornitori</h2>
            <input id="orderSupplier" placeholder="Fornitore">
            <input id="orderTotal" type="number" step="0.01" placeholder="Totale (‚Ç¨)">
            <button onclick="addOrder()">‚ûï Nuovo Ordine</button>
            <div id="ordersList"></div>
        </div>
        
        <div id="stats" class="tab-content">
            <h2>üìä Dashboard Oggi</h2>
            <div class="stats">
                <div class="stat">
                    <h3 id="todayTotal">0‚Ç¨</h3>
                    <p>Incassi Oggi</p>
                </div>
                <div class="stat">
                    <h3 id="posTotal">0‚Ç¨</h3>
                    <p>POS</p>
                </div>
                <div class="stat">
                    <h3 id="cashTotal">0‚Ç¨</h3>
                    <p>Contanti</p>
                </div>
                <div class="stat">
                    <h3 id="sardexTotal">0</h3>
                    <p>Sardex</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        let inventory = JSON.parse(localStorage.getItem('inventory')) || [];
        let recipes = JSON.parse(localStorage.getItem('recipes')) || [];
        let orders = JSON.parse(localStorage.getItem('orders')) || [];
        let incassi = JSON.parse(localStorage.getItem('incassi')) || [];

        const today = new Date().toISOString().split('T')[0];
        document.getElementById('incassoData').value = today;

        function showTab(tab) {
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.getElementById(tab).classList.add('active');
            event.target.classList.add('active');
            updateDisplay();
        }

        function addIncasso() {
            const data = document.getElementById('incassoData').value;
            const pos = parseFloat(document.getElementById('posAmount').value) || 0;
            const cash = parseFloat(document.getElementById('cashAmount').value) || 0;
            const sardex = parseFloat(document.getElementById('sardexAmount').value) || 0;
            const note = document.getElementById('noteAmount').value;
            
            if (pos || cash || sardex) {
                incassi.push({data, pos, cash, sardex, note, total: pos+cash});
                localStorage.setItem('incassi', JSON.stringify(incassi));
                document.getElementById('posAmount').value = '';
                document.getElementById('cashAmount').value = '';
                document.getElementById('sardexAmount').value = '';
                document.getElementById('noteAmount').value = '';
                updateIncassi();
                updateDisplay();
            }
        }

        function updateIncassi() {
            const list = document.getElementById('incassiList');
            list.innerHTML = incassi.map((inc, i) => 
                `<div class="item ${inc.data === today ? 'today-highlight' : ''}">
                    ${inc.data}: POS ${inc.pos.toFixed(2)}‚Ç¨ + Contanti ${inc.cash.toFixed(2)}‚Ç¨ + Sardex ${inc.sardex}cr ${inc.note ? '‚Ä¢ ' + inc.note : ''}
                    <div><strong>Tot: ${(inc.pos+inc.cash).toFixed(2)}‚Ç¨</strong> <button onclick="removeIncasso(${i})">üóëÔ∏è</button></div>
                </div>`
            ).join('');
        }

        // [Le altre funzioni rimangono identiche: addItem, addRecipe, addOrder, updateInventory, etc.]
        function addItem() {
            const name = document.getElementById('itemName').value;
            const qty = parseFloat(document.getElementById('itemQty').value);
            const price = parseFloat(document.getElementById('itemPrice').value);
            if (name && qty && price) {
                inventory.push({name, qty, price, value: qty*price});
                localStorage.setItem('inventory', JSON.stringify(inventory));
                document.getElementById('itemName').value = '';
                document.getElementById('itemQty').value = '';
                document.getElementById('itemPrice').value = '';
                updateInventory();
            }
        }

        function updateInventory() {
            const list = document.getElementById('inventoryList');
            list.innerHTML = inventory.map((item, i) => 
                `<div class="item">${item.name}: ${item.qty}kg @ ${item.price}‚Ç¨ = ${item.value.toFixed(2)}‚Ç¨ <button onclick="removeItem(${i})">üóëÔ∏è</button></div>`
            ).join('');
        }

        function addRecipe() {
            const name = document.getElementById('recipeName').value;
            const cost = parseFloat(document.getElementById('recipeCost').value);
            const price = parseFloat(document.getElementById('recipePrice').value);
            if (name && cost && price) {
                recipes.push({name, cost, price, profit: price-cost});
                localStorage.setItem('recipes', JSON.stringify(recipes));
                document.getElementById('recipeName').value = '';
                document.getElementById('recipeCost').value = '';
                document.getElementById('recipePrice').value = '';
                updateRecipes();
            }
        }

        function updateRecipes() {
            const list = document.getElementById('recipesList');
            list.innerHTML = recipes.map((r, i) => 
                `<div class="item">${r.name}: ${r.cost.toFixed(2)}‚Ç¨ ‚Üí ${r.price.toFixed(2)}‚Ç¨ (Margine: ${r.profit.toFixed(2)}‚Ç¨) <button onclick="removeRecipe(${i})">üóëÔ∏è</button></div>`
            ).join('');
        }

        function addOrder() {
            const supplier = document.getElementById('orderSupplier').value;
            const total = parseFloat(document.getElementById('orderTotal').value);
            if (supplier && total) {
                orders.push({supplier, total, date: new Date().toLocaleDateString()});
                localStorage.setItem('orders', JSON.stringify(orders));
                document.getElementById('orderSupplier').value = '';
                document.getElementById('orderTotal').value = '';
                updateOrders();
            }
        }

        function updateOrders() {
            const list = document.getElementById('ordersList');
            list.innerHTML = orders.map((o, i) => 
                `<div class="item">${o.supplier}: ${o.total.toFixed(2)}‚Ç¨ (${o.date}) <button onclick="removeOrder(${i})">üóëÔ∏è</button></div>`
            ).join('');
        }

        function updateDisplay() {
            const todayIncassi = incassi.filter(i => i.data === today);
            const todayTotal = todayIncassi.reduce((sum, i) => sum + i.total, 0);
            const posTotal = todayIncassi.reduce((sum, i) => sum + i.pos, 0);
            const cashTotal = todayIncassi.reduce((sum, i) => sum + i.cash, 0);
            const sardexTotal = todayIncassi.reduce((sum, i) => sum + i.sardex, 0);
            
            document.getElementById('todayTotal').textContent = todayTotal.toFixed(2) + '‚Ç¨';
            document.getElementById('posTotal').textContent = posTotal.toFixed(2) + '‚Ç¨';
            document.getElementById('cashTotal').textContent = cashTotal.toFixed(2) + '‚Ç¨';
            document.getElementById('sardexTotal').textContent = sardexTotal + ' cr';
            
            updateIncassi();
        }

        function removeIncasso(i) { incassi.splice(i,1); localStorage.setItem('incassi', JSON.stringify(incassi)); updateDisplay(); }
        function removeItem(i) { inventory.splice(i,1); localStorage.setItem('inventory', JSON.stringify(inventory)); updateInventory(); }
        function removeRecipe(i) { recipes.splice(i,1); localStorage.setItem('recipes', JSON.stringify(recipes)); updateRecipes(); }
        function removeOrder(i) { orders.splice(i,1); localStorage.setItem('orders', JSON.stringify(orders)); updateOrders(); }

        updateDisplay();
    </script>
</body>
</html>
