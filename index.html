<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<title>Rosso Dorato Asproni</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body {background:#111;color:#fff;font-family:Arial;padding:20px}
h1,h2{text-align:center}
.card{background:#1e1e1e;padding:15px;border-radius:10px;margin-bottom:20px}
input,select,button{width:100%;padding:10px;margin:5px 0;border-radius:6px;border:none}
button{background:#b30000;color:#fff;font-weight:bold}
.small{font-size:14px;color:#ccc}
</style>
</head>

<body>

<h1>üç∑ Rosso Dorato Asproni</h1>

<div class="card">
<h2>Inserisci giornata</h2>

<input type="date" id="data">

<input type="number" placeholder="Incassi contanti" id="incC">
<input type="number" placeholder="Incassi POS" id="incP">
<input type="number" placeholder="Satispay" id="incS">

<input type="number" placeholder="Spese food" id="sf">
<input type="text" placeholder="Fornitore food" id="ff">
<select id="pf"><option>Contanti</option><option>POS</option><option>Bonifico</option></select>

<input type="number" placeholder="Spese non food" id="snf">
<input type="text" placeholder="Fornitore non food" id="fnf">
<select id="pnf"><option>Contanti</option><option>POS</option><option>Bonifico</option></select>

<input type="number" placeholder="Extra personale" id="extra">
<input type="text" placeholder="Nome personale" id="nomeExtra">
<select id="pex"><option>Contanti</option><option>POS</option><option>Bonifico</option></select>

<button onclick="salva()">üíæ Salva giornata</button>
</div>

<div class="card">
<h2>Storico (mese)</h2>
<select id="mese" onchange="storico()"></select>
<p id="totali"></p>
</div>

<div class="card">
<h2>Spese per fornitore / personale</h2>
<div id="fornitori"></div>
</div>

<button onclick="export()">üì§ Esporta dati</button>

<script>
let dati=JSON.parse(localStorage.getItem("rd"))||{}

function salva(){
let d=data.value;if(!d)return alert("Data mancante")
let m=d.slice(0,7)
if(!dati[m])dati[m]=[]
dati[m].push({
data:d,
inc:+incC.value+ +incP.value+ +incS.value,
sp:[
{t:"Food",i:+sf.value||0,n:ff.value,p:pf.value},
{t:"NonFood",i:+snf.value||0,n:fnf.value,p:pnf.value},
{t:"Extra",i:+extra.value||0,n:nomeExtra.value,p:pex.value}
]
})
localStorage.setItem("rd",JSON.stringify(dati))
alert("Salvato ‚úÖ")
mesi()
}

function mesi(){
mese.innerHTML=""
for(let m in dati)mese.innerHTML+=`<option>${m}</option>`
storico()
}

function storico(){
let m=mese.value;if(!m)return
let inc=0,sp=0,map={}
dati[m].forEach(g=>{
inc+=g.inc
g.sp.forEach(s=>{
sp+=s.i
if(s.n)map[s.n]=(map[s.n]||0)+s.i
})
})
totali.innerText=`Incassi ‚Ç¨${inc} ‚Äì Spese ‚Ç¨${sp} ‚Äì Utile ‚Ç¨${inc-sp}`
fornitori.innerHTML=""
for(let k in map)fornitori.innerHTML+=`<div class="small">${k}: ‚Ç¨${map[k]}</div>`
}

function export(){
let a=document.createElement("a")
a.href="data:text/json,"+encodeURIComponent(JSON.stringify(dati,null,2))
a.download="rosso_dorato.json"
a.click()
}

mesi()
</script>

</body>
</html>
